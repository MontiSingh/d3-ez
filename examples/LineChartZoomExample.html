<!DOCTYPE html>
<html>

<head>
  <title>d3-ez : Line Chart (Zoom) Example</title>
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <script src="../build/d3-ez.js"></script>
  <link rel="stylesheet" type="text/css" href="../build/d3-ez.css" />
</head>

<body>
  <div id="chartholder"></div>
  <br />
  <div>Value: <span id="message"></span></div>

  <script type="text/javascript">
    let url = "https://api.npmjs.org/downloads/range/2018-01-01:2018-09-30/d3-ez";
    (async function() {
      let data = await d3.json(url);

      // NPM Stats API

      let chart = d3.ez.chart.lineChart()
        .width(600)
        .height(400)
        .margin({top: 10, right: 10, bottom: 60, left: 40})
        .on("customValueMouseOver", function(d) {
          console.log(d.value);
        });

      // Convert data into d3-ez format
      let series = data.downloads.map(rec => {
        return {
          key: new Date(rec.day) / 1000,
          value: rec.downloads
        };
      });
      let chartData = [{
        key: data.package,
        values: series
      }];

      d3.select('#chartholder')
        .datum(chartData)
        .call(chart);
    })();
  </script>
</body>

</html>
